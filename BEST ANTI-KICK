local p = game:GetService("Players").LocalPlayer

local R = {}

local function F(r)
    if R[r] then
        return true
    end

    local n = r.Name
    if #n == 36 and string.match(n, "^%x%x%x%x%x%x%x%x%-%x%x%x%x%-%x%x%x%x%-%x%x%x%x%-%x%x%x%x%x%x%x%x%x%x%x%x$") then
        R[r] = true
        return true
    end

    return false
end

local o
o = hookfunction(Instance.new("RemoteEvent").FireServer, function(s, ...)
    local a = {...}
    
    if F(s) then
        return o(s, ...)
    end
    
    for _, v in ipairs(a) do
        if type(v) == "string" and string.find(string.lower(v), "kick") then
            return
        end
    end
    
    return o(s, ...)
end)

local n
n = hookmetamethod(game, "__namecall", function(s, ...)
    if s == p and getnamecallmethod():lower() == "kick" then
        return
    end
    return n(s, ...)
end)

local k
k = hookfunction(p.Kick, function(s, ...)
    if s == p then
        return
    end
    return k(s, ...)
end)

local hookedFunctions = {}
task.spawn(function()
    setthreadidentity(2)
    for _, obj in getgc(true) do
        if typeof(obj) == "table" then
            local Detected = rawget(obj, "Detected")
            local Kill = rawget(obj, "Kill") 
            local Disconnect = rawget(obj, "Disconnect")
            
            if typeof(Detected) == "function" and not table.find(hookedFunctions, Detected) then
                hookfunction(Detected, function(action, info, nocrash)
                    if action ~= "_" then
                    end
                    return true
                end)
                table.insert(hookedFunctions, Detected)
            end
            
            if typeof(Kill) == "function" and not table.find(hookedFunctions, Kill) then
                hookfunction(Kill, function(...) return end)
                table.insert(hookedFunctions, Kill)
            end
            
            if typeof(Disconnect) == "function" and not table.find(hookedFunctions, Disconnect) then
                hookfunction(Disconnect, function(...) return end)
                table.insert(hookedFunctions, Disconnect)
            end
        end
    end
end)
